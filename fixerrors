#!/usr/bin/env bash
#
# fixerrors - Automated error analysis and fixing
#
# Usage: ./fixerrors
#
# This script analyzes errors from the /debug page's Application Error Log,
# matches them against known patterns, and auto-applies fixes where possible.
#
# The error fix log is maintained at: docs_private/error-fix-log.md
#

set -e

# Get the directory where this script is located (repo root)
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# Change to repo root
cd "$SCRIPT_DIR"

# Check for required environment file
if [ ! -f ".env.local" ]; then
  echo "‚ùå Error: .env.local not found"
  echo "   Please ensure .env.local exists with NEXT_PUBLIC_SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY"
  exit 1
fi

# Run the TypeScript script using npx (uses local dev dependency)
npx tsx scripts/fixerrors.ts
