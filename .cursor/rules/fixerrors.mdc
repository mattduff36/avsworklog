---
description: Triggered when the user types "fixerrors" or "fix errors" in chat. Runs the error analysis script, reads the report, and fixes codebase issues.
globs: 
alwaysApply: false
---

# fixerrors — Automated Error Analysis & Fix Workflow

When the user types "fixerrors" or "fix errors", execute the following steps **in order** without asking for confirmation:

## Step 1: Run the analysis script

Run this command in the terminal:

```bash
npm run fixerrors
```

Wait for it to complete. It fetches production errors from the `error_logs` database table (excluding localhost and admin errors), groups them into patterns, and writes a structured report.

## Step 2: Read the analysis report

Read the file `docs_private/error-analysis.md`. This file is overwritten each run and contains:

- A summary table of all error patterns (sorted by frequency)
- Detailed breakdowns per pattern including: error message, affected pages, source file references (parsed from stack traces), stack trace excerpts, and timestamps
- A cross-cutting pattern analysis (errors by component, by type, hotspot pages, shared source files)
- An actionable items list

## Step 3: Analyze and fix codebase issues

For **each error pattern** in the report:

1. Read the source files listed under "Source files (from stack trace)" if any are present.
2. Determine whether the error is caused by a bug or issue in the codebase (as opposed to external/network/user-input issues).
3. If it IS a codebase issue, fix it directly by editing the relevant source file(s).
4. If it is NOT a codebase issue (e.g., network timeout, third-party API failure, user error), note it but do not attempt a fix.

## Step 4: Pattern analysis

After processing individual errors, review the **Pattern Analysis** section of the report:

- Look for components or pages that appear in multiple error patterns — these indicate systemic issues.
- Look for source files that appear across multiple patterns — these are high-value fix targets.
- Look for error types that cluster together — these may share a common root cause.
- Investigate and resolve any cross-cutting issues you identify.

## Step 5: Report back

After completing all fixes, provide a clear summary:

- List each error pattern and what action was taken (fixed / not a codebase issue / needs manual investigation)
- List any cross-cutting patterns found and actions taken
- If any errors could not be fixed automatically, explain why and suggest what the user should investigate manually

## Important notes

- The error data comes from the Supabase `error_logs` table (production runtime errors captured by the app's error logging system).
- The `/debug` page in the app shows the same data. The script applies the same default filters (no localhost, no admin account).
- Historical tracking data is in `docs_private/error-fix-log.md` (JSON format). You generally do not need to read this file unless you want historical context on a specific error.
- After fixing errors, commit changes following the project's git conventions (feature branch, clear commit message). Do NOT push unless the user says "push to GitHub".
